<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>map-editor</title>
    <style>
      * { margin: 0; padding: 0; box-sizing: border-box; }
      body {
        font-family: system-ui, sans-serif;
        background: #1a1a1a;
        color: #eee;
        display: flex;
        height: 100vh;
        overflow: hidden;
      }

      #sidebar {
        width: 240px;
        display: flex;
        flex-direction: column;
        background: #222;
        border-right: 1px solid #333;
        flex-shrink: 0;
        overflow-y: auto;
      }

      #controls {
        padding: 16px;
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      #controls h1 { font-size: 18px; margin-bottom: 4px; }
      #controls label { font-size: 13px; color: #aaa; display: block; margin-bottom: 4px; }
      #controls input[type="text"],
      #controls input[type="number"],
      #controls select {
        width: 100%;
        padding: 6px 8px;
        border: 1px solid #444;
        border-radius: 4px;
        background: #2a2a2a;
        color: #eee;
        font-size: 14px;
      }
      #controls input[type="range"] {
        width: 100%;
      }
      #controls button {
        width: 100%;
        padding: 8px;
        border: none;
        border-radius: 4px;
        background: #3a6;
        color: #fff;
        font-size: 14px;
        font-weight: bold;
        cursor: pointer;
      }
      #controls button:hover { background: #4b7; }

      .mode-btn {
        flex: 1 1 28%;
        min-width: 0;
        padding: 6px 0 !important;
        text-align: center;
        cursor: pointer;
        background: #2a2a2a !important;
        border: 1px solid #444 !important;
        border-radius: 4px;
        color: #aaa;
        font-size: 12px !important;
        font-weight: normal !important;
      }
      .mode-btn:hover { background: #333 !important; }
      .mode-btn.active { background: #335 !important; color: #fff; border-color: #668 !important; }

      .terrain-swatch {
        width: 32px;
        height: 32px;
        border-radius: 4px;
        border: 2px solid transparent;
        cursor: pointer;
        display: inline-block;
      }
      .terrain-swatch.active { border-color: #fff; }

      .section-label {
        font-size: 11px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        color: #666;
        margin-top: 4px;
      }

      #map-list {
        border-top: 1px solid #333;
        flex: 1;
        overflow-y: auto;
        padding: 8px 0;
      }
      #map-list .map-item {
        padding: 8px 16px;
        cursor: pointer;
        font-size: 14px;
        color: #aaa;
        transition: background 0.1s;
      }
      #map-list .map-item:hover { background: #2a2a2a; }
      #map-list .map-item.active { background: #335; color: #fff; }
      #map-list .empty-msg {
        padding: 8px 16px;
        font-size: 13px;
        color: #555;
        font-style: italic;
      }

      #main-area {
        flex: 1;
        position: relative;
        overflow: hidden;
      }

      #map-canvas {
        display: block;
        width: 100%;
        height: 100%;
        cursor: crosshair;
      }

      #status-bar {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 24px;
        background: rgba(0,0,0,0.7);
        color: #888;
        font-size: 12px;
        line-height: 24px;
        padding: 0 8px;
        pointer-events: none;
      }

      #preview-3d {
        display: none;
        position: absolute;
        bottom: 32px;
        left: 8px;
        width: 380px;
        height: 260px;
        background: #111;
        border: 1px solid #444;
        border-radius: 6px;
        overflow: hidden;
        z-index: 20;
        box-shadow: 0 4px 20px rgba(0,0,0,0.5);
      }

      #preview-3d-close {
        position: absolute;
        top: 4px;
        right: 4px;
        z-index: 21;
        width: 22px;
        height: 22px;
        border: none;
        border-radius: 4px;
        background: rgba(0,0,0,0.5);
        color: #aaa;
        font-size: 14px;
        line-height: 22px;
        text-align: center;
        cursor: pointer;
        padding: 0;
      }
      #preview-3d-close:hover { background: rgba(255,255,255,0.15); color: #fff; }

      #preview-3d-open {
        position: absolute;
        bottom: 32px;
        left: 8px;
        z-index: 20;
        width: 32px;
        height: 32px;
        border: 1px solid #444;
        border-radius: 6px;
        background: rgba(34,34,34,0.85);
        color: #aaa;
        font-size: 11px;
        font-weight: bold;
        line-height: 32px;
        text-align: center;
        cursor: pointer;
        padding: 0;
      }
      #preview-3d-open:hover { background: rgba(50,50,50,0.95); color: #fff; }

      .color-row {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-top: 4px;
      }
      .color-row label {
        font-size: 12px;
        color: #aaa;
        flex: 1;
        margin: 0 !important;
      }
      .color-row input[type="color"] {
        width: 32px;
        height: 24px;
        border: 1px solid #444;
        border-radius: 3px;
        background: none;
        cursor: pointer;
        padding: 0;
      }
      .color-row button {
        width: auto !important;
        padding: 2px 6px !important;
        font-size: 11px !important;
        background: #444 !important;
        font-weight: normal !important;
      }
      .color-row button:hover { background: #555 !important; }
    </style>
  </head>
  <body>
    <div id="sidebar">
      <div id="controls">
        <h1>map-editor</h1>

        <div>
          <div class="section-label">Mode</div>
          <div id="mode-btns" style="display:flex;flex-wrap:wrap;gap:4px;margin-top:4px;"></div>
        </div>

        <div id="terrain-options">
          <div class="section-label">Terrain Type</div>
          <div id="terrain-swatches" style="display:flex;gap:8px;margin-top:4px;"></div>
          <div class="section-label" style="margin-top:8px;">Terrain Colors</div>
          <div id="terrain-color-pickers"></div>
        </div>

        <div id="color-options" style="display:none;">
          <div class="section-label">Paint Color</div>
          <div style="display:flex;align-items:center;gap:8px;margin-top:4px;">
            <input id="color-paint" type="color" value="#c2a645" style="width:48px;height:32px;border:1px solid #444;border-radius:3px;background:none;cursor:pointer;padding:0;" />
            <span style="font-size:12px;color:#888;">Left: paint / Right: erase</span>
          </div>
        </div>

        <div>
          <label for="brush-size">Brush Size: <span id="brush-size-val">4</span></label>
          <input id="brush-size" type="range" min="1" max="32" value="4" />
        </div>

        <div style="display:flex;align-items:center;gap:8px;">
          <input id="show-height" type="checkbox" />
          <label for="show-height" style="cursor:pointer;margin:0;">Show height overlay</label>
        </div>

        <div id="height-options">
          <label for="height-strength">Height Strength: <span id="height-strength-val">0.10</span></label>
          <input id="height-strength" type="range" min="1" max="100" value="10" />
        </div>

        <div>
          <div class="section-label">Map</div>
          <label for="map-name">Map Name</label>
          <input id="map-name" type="text" value="untitled" />
        </div>

        <div>
          <label for="map-size">Map Size</label>
          <select id="map-size">
            <option value="128">128 x 128</option>
            <option value="256" selected>256 x 256</option>
            <option value="512">512 x 512</option>
            <option value="1024">1024 x 1024</option>
          </select>
        </div>

        <button id="save-btn">Save</button>
        <button id="new-map-btn" style="background:#555;">New Map</button>
      </div>
      <div id="map-list"></div>
    </div>
    <div id="main-area">
      <canvas id="map-canvas"></canvas>
      <div id="status-bar">Ready</div>
      <div id="preview-3d">
        <button id="preview-3d-close">&times;</button>
      </div>
      <button id="preview-3d-open">3D</button>
    </div>
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
